---
title: "Modul08-Simple Linear Regression"
author: "Roni Yunis"
date: "3/19/2021"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Load Packages
```{r}
#Split dataset 
library (caTools)
#Predicting result visualization
library(ggplot2)
#Import format data xlsx
library(readxl)

```

# Import dataset
```{r}
credit <- read_excel("data/Credit Risk Data.xlsx", sheet = "Base Data")
head(credit)
```

Melihat dimensi dari data, dengan menggunakan fungsi dim()
```{r}
dim(credit)
```
Melihat struktur dari data, dengan menggunakan fungsi str()
```{r}
str(credit)
```
#Cek data kosong/missing value

```{r}
summary(credit)
```



Sekarang kita akan mencoba melihat korelasi antara Age (Umur) dengan MonthsEmployed (Bulan Bekerja). 

```{r}
#menghitung korelasi antar variabel
korelasi <- cor(credit$Age, credit$MonthsEmployed)
korelasi
```
Koefisien korelasi mengukur tingkat hubungan antara dua variabel x dan y. Nilainya berkisar antara -1 (korelasi negatif sempurna: ketika x meningkat, y menurun) dan +1 (korelasi positif sempurna: ketika x meningkat, y meningkat).

Nilai yang mendekati 0 menunjukkan hubungan yang lemah antara variabel. Korelasi yang rendah (-0,2 <x <0,2) mungkin menunjukkan bahwa banyak variasi dari variabel hasil (y) tidak dijelaskan oleh prediktor (x). Dalam kasus seperti itu, kita mungkin harus mencari variabel prediktor yang lebih baik.

Dalam contoh ini, koefisien korelasinya tidak terlalu besar  yaitu 0,31, jadi kita bisa melanjutkan dengan membangun model linier y sebagai fungsi dari x.

# Bagi dataset kedalam data training dan data testing
```{r}
splitdata <- sample.split(credit$MonthsEmployed, SplitRatio = 0.7)
trainingset <- subset(credit, splitdata == TRUE)
testingset <- subset(credit, splitdata == FALSE)
```

# Lakukan liner regresi sederhana pada data training
```{r}
lm.r <- lm(formula = MonthsEmployed ~ Age,
           data = trainingset)
coef(lm.r)
```
Berdasarkan output diatas bisa dijelaskan bahwa:
Persamaan regresi linernya adalah MonthsEmployed = 5,91 + 0,75*Age

Sebelum menggunakan rumus ini untuk memprediksi Bulan Bekerja di masa mendatang, Anda harus memastikan bahwa model ini signifikan secara statistik, yaitu: 
Ada hubungan yang signifikan secara statistik antara prediktor dan variabel hasil, kita akan memeriksa kualitas model regresi linier.

# Summary dari model
```{r}
summary(lm.r)
```

# Prediksi model regresi dengan data testing
```{r}
yprediksi <- predict(lm.r, newdata = testingset)

```


# Visualasi hasil data training
```{r}
ggplot() + geom_point(aes(x = trainingset$Age,
                          y = trainingset$MonthsEmployed), colour = 'red') +
  geom_line(aes(x = trainingset$Age,
                y = predict(lm.r, newdata = trainingset)), colour = 'blue') +
  ggtitle('Age vs Months Employed (Data Training)') +
  xlab('Age') +
  ylab('Months Employed')
```

# Visualasi hasil data testing
```{r}
ggplot() + geom_point(aes(x = testingset$Age,
                          y = testingset$MonthsEmployed), colour = 'red') +
  geom_line(aes(x = testingset$Age,
                y = predict(lm.r, newdata = testingset)), colour = 'blue') +
  ggtitle('Age vs Months Employed (Data Testing)') +
  xlab('Age') +
  ylab('Months Employed')
```



